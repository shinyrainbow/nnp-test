generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  clerkId   String   @unique
  email     String?  @unique
  firstName String?
  lastName  String?
  name      String?
  imageUrl  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

enum PropertyStatus {
  available
  sold
  rented
  pending
}

enum RoomType {
  Condo
  Townhouse
  SingleHouse
  Apartment
  Other
}

model Project {
  id                 String   @id @default(uuid())
  projectNameEn      String?
  projectNameTh      String?
  projectCode        String?   @unique // RHB
  projectLocation    String[] @default([]) // ["Phetchaburi", "Makkasan", "Bangkok"]
  projectImageUrl    String[] @default([]) // main building, facilities, etc.
  projectFacilities  String[] @default([]) // list of facilities like "swimming pool", "gym", etc.
 
  addressNumberRoad  String? // 42 Sukhumvit 101/1
  addressSubDistrict String? // Makkasan
  addressDistrict    String?
  addressProvince    String?
  addressZipcode     String?
 
  completeYear       String? // January 2023
  distanceToStation  Int[]    @default([]) // ["300m to BTS Ekamai", "400m to MRT Thonglor"]
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  // Relation
  properties Property[]

  @@map("projects")
}

model Property {
  id                  String @id @default(uuid())
  projectId           String @unique
  projectPropertyCode String @unique // RHB-1 (project-number)

  // status
  status        PropertyStatus? @default(pending)
  whenAvailable     String?
  isAcceptShortTerm Boolean? @default(false)

  // details
  addressNumber String? // 42/188
  bedRoom       Int?
  bathRoom      Int?
  roomSize      Float? // in sqm
  floor         Int?
  building      String?
  roomType      RoomType?       @default(Condo)
  isPetFriendly Boolean? @default(false)
  carPark       Int?
  imageUrls     String[] @default([])
  roomAmenities String[] @default([])

  // price
  rentalRate    Decimal?        @db.Decimal(12, 2)
  sellPrice     Decimal?        @db.Decimal(14, 2)

  // contact
  phone  String?
  lineId String?
  fbUrl  String?
  
  isOwner       Boolean? @default(false)

  // messages
  note          String? // for some more details
  originalMessage String?
  messageToPost String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relation
  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
  @@index([status])
  @@map("properties")
}
